import { v } from "convex/values";

export async function generateSessionToken(secret: string, timestamp: number) {
  const windowStep = Math.floor(timestamp / 15000);
  // ...
}

const currentToken = await generateSessionToken(session.code!, now);
const previousToken = await generateSessionToken(session.code!, now - 15000);
const previousToken2 = await generateSessionToken(session.code!, now - 30000);
      
if (args.code !== currentToken && args.code !== previousToken && args.code !== previousToken2) {
  throw new Error("Invalid or expired QR Code. Please scan again.");
}